# 5.4 AI辅助测试用例实战

前面三节聊了认知和方法论，从这一节开始我们进入实操环节。我会给出具体的Prompt模板和操作步骤，你可以直接拿去用，也可以根据自己的业务做调整。

我们用一个贴近实际的需求来贯穿整个流程：一个电商平台的"订单退款"功能。

## 第一步：用AI从PRD生成测试用例

这是最常用的场景。你拿到一份需求文档，需要输出测试用例。我按测试类型准备了三个Prompt模板。

### 模板一：功能测试用例生成

```
你是一位资深测试工程师，请根据以下需求文档生成功能测试用例。

【需求描述】
订单退款功能：
1. 用户可以对已支付、待发货状态的订单申请全额退款
2. 已发货的订单需要先申请退货，退货完成后系统自动发起退款
3. 退款金额原路返回至用户支付账户
4. 退款处理时间：微信/支付宝 1-3个工作日，银行卡 3-7个工作日
5. 每个订单只能申请一次退款
6. 管理员可以在后台审核退款申请，可选择通过或拒绝（需填写拒绝原因）

【输出要求】
- 按"模块-功能点"分组
- 每条用例包含：用例编号、用例标题、前置条件、操作步骤、预期结果、优先级（P0-P3）
- 用表格格式输出
- 覆盖正常流程和基本的异常流程
```

这个模板的要点在于：需求描述要具体（不要丢一个PDF链接让AI自己猜），输出要求要明确（格式、字段、分组方式都说清楚）。如果你的需求文档很长，可以分模块喂给AI，每次处理一个模块。

### 模板二：边界测试用例生成

```
你是一位资深测试工程师，擅长边界值分析。请基于以下功能规则，生成边界测试用例。

【功能规则】
订单退款功能的约束条件：
- 退款金额范围：0.01元 - 99999.99元（与订单实际支付金额一致）
- 退款申请时间限制：订单支付成功后30天内
- 退款原因文字说明：必填，10-500个字符
- 同一用户同时进行中的退款申请数量上限：5个

【要求】
针对以上每条约束，列出：
1. 边界值（刚好在边界上的值）
2. 边界值的邻近值（边界值±1）
3. 无效边界值（超出范围的值）
4. 特殊值（空值、极端值、特殊字符等）

每条用例包含：输入值、操作描述、预期结果。用表格格式输出。
```

这个模板的关键是把约束条件用明确的数值范围写出来。AI在处理有明确数值边界的场景时非常靠谱，它能系统性地列出所有你应该测试的边界点。

### 模板三：异常测试用例生成

```
你是一位资深测试工程师，特别擅长发现系统异常场景。请基于以下功能描述，设计异常和容错测试用例。

【功能描述】
电商平台订单退款流程：用户提交退款申请 → 系统校验订单状态 → 管理员审核 → 系统执行退款 → 通知用户退款结果

【请从以下维度思考异常场景】
1. 并发与时序：多人同时操作、操作顺序异常
2. 数据异常：脏数据、数据不一致、数据被篡改
3. 依赖服务异常：支付网关超时、短信服务不可用、数据库连接中断
4. 用户操作异常：重复提交、浏览器后退重提、中途关闭页面
5. 权限与安全：越权操作、接口参数篡改
6. 性能边界：大量退款申请并发处理

每条用例包含：异常场景描述、触发条件、操作步骤、预期系统行为。按维度分组，用表格输出。
```

异常测试是AI最能帮你拓展思路的地方。你可能平时会想到并发和数据异常，但"浏览器后退重提""接口参数篡改"这些场景容易遗漏。这个模板的价值在于给了AI一个思考框架，让它沿着多个维度去穷举。

## 第二步：用AI做用例评审与查漏补缺

生成用例只是第一步，更重要的是评审。你可以把自己写的用例（或AI生成后你初步筛选过的用例）丢给AI做一次评审。

### 用例评审Prompt模板

```
你是一位测试专家，请对以下测试用例进行评审。

【需求背景】
（在这里粘贴需求描述的简要版本）

【待评审的测试用例】
（在这里粘贴你的测试用例）

【请从以下角度评审】
1. 覆盖完整性：是否有功能点未被测试用例覆盖？
2. 场景遗漏：是否遗漏了重要的异常场景、边界条件、兼容性场景？
3. 用例质量：步骤是否可执行？预期结果是否明确可验证？前置条件是否完整？
4. 冗余检查：是否有重复或高度相似的用例可以合并？
5. 优先级合理性：P0/P1的用例是否真的是核心场景？有没有重要场景被标为低优先级？

请输出：
- 发现的问题清单（按严重程度排序）
- 建议补充的测试用例
- 建议删除或合并的用例
```

这个模板的巧妙之处在于：你让AI去review用例，而不是让同一个AI先生成再review自己的输出。如果生成和评审在两个独立的对话中进行，效果会更好，因为AI不会受到"这是我自己生成的"这种偏差影响。

## 第三步：用AI生成测试数据

测试数据的构造是另一个耗时的工作，特别是当你需要大量符合特定规则的数据时。

### 常见数据场景的Prompt

**批量用户数据：**
```
请生成20条测试用的用户数据，JSON格式，每条包含：
- username：6-20位字母数字组合，不重复
- phone：中国大陆手机号格式，以13/15/17/18/19开头
- email：有效邮箱格式
- age：18-70之间的整数，分布尽量均匀
- register_date：2024年1月至2025年6月之间的随机日期

其中要包含以下特殊数据：
- 2条username刚好6位（下限）
- 2条username刚好20位（上限）
- 2条age为18（下限边界）
- 1条email使用不常见的域名后缀（如.museum）
```

**关联订单数据：**
```
请生成一组用于测试退款流程的订单数据，JSON格式，需要覆盖以下状态：
- 待支付订单 2条
- 已支付待发货订单 3条（其中1条有优惠券抵扣）
- 已发货订单 2条
- 已完成订单 2条
- 已取消订单 1条
- 已申请退款订单 2条（1条待审核，1条已拒绝）

每条订单包含：order_id, user_id, product_name, amount, pay_method(微信/支付宝/银行卡), status, create_time, pay_time
确保金额覆盖：小额(0.01-10元)、普通(100-1000元)、大额(10000元以上)
```

生成测试数据时，关键是在Prompt里把数据规则和你需要的特殊场景说清楚。AI非常擅长按规则批量生成数据，这比你手动编造快几十倍，而且不容易出格式错误。

## 完整工作流示例：从需求到用例全过程

最后我把整个流程串起来，展示一下实际工作中的操作顺序。

**步骤一：需求理解。** 先让AI帮你梳理需求的核心测试关注点。

```
请阅读以下需求文档，帮我提取出所有需要测试的功能点、业务规则和约束条件，按模块分组列出。

（粘贴需求文档内容）
```

拿到AI的输出后，对照你自己对需求的理解做一次核对。看看有没有AI理解错的地方，也看看有没有你忽略的点。

**步骤二：生成用例初稿。** 用前面的三个模板，分别生成功能测试、边界测试和异常测试用例。如果需求比较复杂，按模块拆分，每个模块单独生成。

**步骤三：人工初筛。** 快速过一遍AI生成的所有用例，删掉明显不对的（不符合业务逻辑、不可执行的），合并重复的。这一步不需要精细review，只做粗筛。

**步骤四：AI评审。** 把初筛后的用例用评审模板让AI做一次系统性检查，重点看覆盖率和遗漏项。

**步骤五：人工终审。** 根据AI的评审建议和你自己的业务经验，做最终的调整。补充AI遗漏的业务特殊场景，调整优先级排序，确保用例的可执行性。

**步骤六：生成测试数据。** 根据最终的用例清单，让AI生成配套的测试数据。

整个流程下来，一个中等复杂度的需求从拿到PRD到输出完整测试用例和数据，大概需要1-2小时。如果完全手工做，同样的工作量通常需要一到两天。效率提升很明显，但前提是你在关键环节投入了足够的人工判断。AI是加速器，不是自动驾驶。
